<!DOCTYPE html> <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us"> <head> <script async src="https://www.googletagmanager.com/gtag/js?id=G-3N6CESJ0B5"></script> <script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-3N6CESJ0B5");</script> <link href="http://gmpg.org/xfn/11" rel="profile"> <meta http-equiv="content-type" content="text/html; charset=utf-8"> <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"> <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"> <link rel="manifest" href="/site.webmanifest"> <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1"> <title> On Maintainability: Gold Plating the Game of Life in Elm &middot; effluence </title> <link rel="stylesheet" href="/assets/css/styles.css"> <link rel="preconnect" href="https://fonts.gstatic.com"> <link href="https://fonts.googleapis.com/css2?family=Epilogue&display=swap" rel="stylesheet"> <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml"> <link rel="canonical" href="https://sonnym.com/2017/06/18/on-maintainability-gold-plating-the-game-of-life-in-elm/"> </head> <body class="layout-reverse"> <div class="sidebar"> <div class="container sidebar-sticky"> <div class="sidebar-about"> <h1>effluence</h1> <p class="lead"></p> </div> <ul class="sidebar-nav"> <li class="sidebar-nav-item"> <a href="/">home</a> </li> <li class="sidebar-nav-item"> <a href="/about/">about</a> </li> <li class="sidebar-nav-item"> <a href="/atom.xml" target="_blank">rss</a> </li> </ul> <p>&copy; 2026. All rights reserved.</p> </div> </div> <div class="content container"> <div class="post"> <h1 class="post-title">On Maintainability: Gold Plating the Game of Life in Elm</h1> <h2 id="launch-pad">Launch Pad</h2> <p>In a previous <a href="/2017/05/22/revisiting-the-game-of-life-in-elm/">article</a>, we explored how to write Conway’s Game of Life in the Elm programming language. This example was predicated on one from several years before and compared the differences in Elm over the intervening period of time. Today, we will add some entirely unnecessary features to the simple version of the program.</p> <p>This exercise in <span class="fancylink"> <a href="https://en.wikipedia.org/wiki/Gold_plating_(software_engineering)">gold plating</a> <span> <a href="https://en.wikipedia.org/wiki/Gold_plating_(software_engineering)" target="_blank" alt="Pop Out" title="Pop Out"><svg class="octicon octicon-link-external" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> </span> </span> will serve as a means of probing what it feels like to add new features to an already established Elm program; these microcosmic changes will, hopefully, be reflective of maintaining larger applications in Elm. Throughout the course of this article, we will consider successive diffs, starting from the original implementation, while moving toward the final version.</p> <p>If you would like to see the full source code during any step of the process, please refer to this <span class="fancylink"> <a href="https://gist.github.com/sonnym/ddb7ef3d9d458d2d2e40bf4ef91b2da8">gist</a> <span> <a href="https://gist.github.com/sonnym/ddb7ef3d9d458d2d2e40bf4ef91b2da8" target="_blank" alt="Pop Out" title="Pop Out"><svg class="octicon octicon-link-external" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> </span> </span>.</p> <h2 id="unifying-the-model">Unifying the Model</h2> <p>The first step we must undertake is collapsing the various top level variables, namely <code class="language-plaintext highlighter-rouge">cellSize</code>, <code class="language-plaintext highlighter-rouge">columns</code>, and <code class="language-plaintext highlighter-rouge">rows</code>, into a single <code class="language-plaintext highlighter-rouge">Model</code>. We also incorporate the (previously hardcoded) empty <code class="language-plaintext highlighter-rouge">Grid</code> into our initial <code class="language-plaintext highlighter-rouge">model</code> value. This entire step would be unnecessary, were it not (conveniently) omitted from the original implementation. Generally speaking, it is safer to include extra items in the <code class="language-plaintext highlighter-rouge">Model</code> structure, in the off chance they become variable in the future, rather than having global variables. This would be substantially more important when working with modular code but would also vie against common API considerations (i.e. in deciding what to keep private within a module, as opposed to exposing through a public data structure).</p> <p>Unifying the model is a somewhat messy operation, since it involves changing several type annotations, but this is also very illustrative. We can see how higher level functions deal with the <code class="language-plaintext highlighter-rouge">Model</code> type, which flows down to lower level functions, where it is decomposed piecemeal for functions that only need, for instance, <code class="language-plaintext highlighter-rouge">grid</code> or <code class="language-plaintext highlighter-rouge">cellSize</code> fields. This makes the flow of data through our functions explicitly visible, from top to bottom.</p> <figure class="highlight"><pre><code class="language-diff" data-lang="diff"><span class="gh">diff --git 1/_examples/elm/game_of_life.elm 2/_examples/elm/game_of_life_gold_plated_step1.elm
index 8e9e4c6..58db25f 100644
</span><span class="gd">--- 1/_examples/elm/game_of_life.elm
</span><span class="gi">+++ 2/_examples/elm/game_of_life_gold_plated_step1.elm
</span><span class="p">@@ -9,10 +9,21 @@</span> import Html exposing (Html, Attribute, div, text)
 import Html.Attributes exposing (style)
 
 type alias Grid = List (List Bool)
<span class="gi">+type alias Model =
+  { grid : Grid
+  , rows : Int
+  , columns : Int
+  , cellSize : Int
+  }
</span> type Msg = Initialize Grid | Tick Time
 
<span class="gd">-cellSize = 5
-(columns, rows) = (35, 35)
</span><span class="gi">+model : Model
+model =
+  { grid = [[]]
+  , cellSize = 5
+  , columns = 35
+  , rows = 35
+  }
</span> 
 main =
   Html.program
<span class="p">@@ -22,33 +33,38 @@</span> main =
     , subscriptions = subscriptions
     }
 
<span class="gd">-init : (Grid, Cmd Msg)
</span><span class="gi">+init : (Model, Cmd Msg)
</span> init =
<span class="gd">-  ([[]], Random.generate
-    Initialize
-    (Random.map (groupInto columns) (Random.list (rows * columns) Random.bool)))
</span><span class="gi">+  (model, Random.generate
+     Initialize
+     (Random.map
+       (groupInto model.columns)
+       (Random.list (model.rows * model.columns) Random.bool)))
</span> 
<span class="gd">-view : Grid -&gt; Html msg
-view grid = div [ ] (List.map row grid)
</span><span class="gi">+view : Model -&gt; Html msg
+view model = div [ ] (List.map (row model.cellSize) model.grid)
</span> 
<span class="gd">-update : Msg -&gt; Grid -&gt; (Grid, Cmd Msg)
</span><span class="gi">+update : Msg -&gt; Model -&gt; (Model, Cmd Msg)
</span> update msg state =
   case msg of
<span class="gd">-    Initialize initial -&gt; (initial, Cmd.none)
</span><span class="gi">+    Initialize initial -&gt;
+      ({ state | grid = initial }, Cmd.none)
</span> 
<span class="gd">-    Tick _ -&gt; (evolve state, Cmd.none)
</span><span class="gi">+    Tick _ -&gt;
+      ({ state | grid = evolve state }, Cmd.none)
</span> 
<span class="gd">-subscriptions : Grid -&gt; Sub Msg
</span><span class="gi">+subscriptions : Model -&gt; Sub Msg
</span> subscriptions _ = Time.every Time.second Tick
 
<span class="gd">-row : List Bool -&gt; Html msg
-row row = div [ style [ ("clear", "both") ] ] (List.map cell row)
</span><span class="gi">+row : Int -&gt; List Bool -&gt; Html msg
+row size row =
+  div [ style [ ("clear", "both") ] ] (List.map (cell size) row)
</span> 
<span class="gd">-cell : Bool -&gt; Html msg
-cell on = div [ cellStyle on ] [ text " " ]
</span><span class="gi">+cell : Int -&gt; Bool -&gt; Html msg
+cell size on = div [ cellStyle size on ] [ text " " ]
</span> 
<span class="gd">-cellStyle : Bool -&gt; Attribute msg
-cellStyle on =
</span><span class="gi">+cellStyle : Int -&gt; Bool -&gt; Attribute msg
+cellStyle cellSize on =
</span>   style
     [ ("background", if on then "black" else "white")
     , ("width", toString cellSize ++ "px")
<span class="p">@@ -63,14 +79,14 @@</span> groupInto n lst =
   else
     (List.take n lst) :: (groupInto n (List.drop n lst))
 
<span class="gd">-evolve : Grid -&gt; Grid
-evolve generation =
</span><span class="gi">+evolve : Model -&gt; Grid
+evolve ({grid} as model) =
</span>   List.indexedMap (\y row -&gt;
     List.indexedMap (\x _ -&gt;
<span class="gd">-      descend generation x y) row) generation
</span><span class="gi">+      descend model x y) row) grid
</span> 
<span class="gd">-descend : Grid -&gt; Int -&gt; Int -&gt; Bool
-descend grid x y =
</span><span class="gi">+descend : Model -&gt; Int -&gt; Int -&gt; Bool
+descend {grid, rows, columns} x y =
</span>   List.concatMap (\n -&gt; List.map (\m -&gt; (x + n, y + m))
                    [-1, 0, 1]) [-1, 0, 1]
     |&gt; List.filter (\p -&gt; (first p) &gt; -1 &amp;&amp; (first p) &lt; columns &amp;&amp;</code></pre></figure> <h2 id="restarting-the-simulation">Restarting the Simulation</h2> <p>The first feature we will add is the ability to restart the simulation. This is a fairly straightforward modification, and is the first illustration of the ease with which new features can be added. This is preformed in a few simple steps:</p> <ol> <li>Add a new <code class="language-plaintext highlighter-rouge">Restart</code> type case to our <code class="language-plaintext highlighter-rouge">Msg</code> union type.</li> <li>Draw the button in our <code class="language-plaintext highlighter-rouge">view</code> functions, configured to generate our <code class="language-plaintext highlighter-rouge">Restart</code> message when clicked.</li> <li>Handle the <code class="language-plaintext highlighter-rouge">Restart</code> case in the <code class="language-plaintext highlighter-rouge">update</code> function.</li> </ol> <p>This latter point did require the factoring of a separate <code class="language-plaintext highlighter-rouge">seed</code> function for generating the command to repopulate the <code class="language-plaintext highlighter-rouge">grid</code> from the <code class="language-plaintext highlighter-rouge">init</code> function, but that is more corollary than an integral aspect of adding this feature. We also needed to import some additional modules (and expose some additional functions on those already imported).</p> <p>(N.B. A cursory search regarding the terminology for particular concrete cases of a union type appears to be <span class="fancylink"> <a href="http://web.cs.ucla.edu/~palsberg/tba/papers/turbak-dimock-muller-wells-tic97.pdf">virtual variant</a> <span> <a href="http://web.cs.ucla.edu/~palsberg/tba/papers/turbak-dimock-muller-wells-tic97.pdf" target="_blank" alt="Pop Out" title="Pop Out"><svg class="octicon octicon-link-external" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> </span> </span>, though this is not part of the Elm vernacular.)</p> <figure class="highlight"><pre><code class="language-diff" data-lang="diff"><span class="gh">diff --git 1/_examples/elm/game_of_life_gold_plated_step1.elm 2/_examples/elm/game_of_life_gold_plated_step2.elm
index 58db25f..f2874ec 100644
</span><span class="gd">--- 1/_examples/elm/game_of_life_gold_plated_step1.elm
</span><span class="gi">+++ 2/_examples/elm/game_of_life_gold_plated_step2.elm
</span><span class="p">@@ -5,7 +5,8 @@</span> import Random
 import Time exposing (Time)
 import Tuple exposing (first, second)
 
<span class="gd">-import Html exposing (Html, Attribute, div, text)
</span><span class="gi">+import Html exposing (Html, Attribute, div, label, button, text)
+import Html.Events exposing (onClick)
</span> import Html.Attributes exposing (style)
 
 type alias Grid = List (List Bool)
<span class="p">@@ -15,7 +16,10 @@</span> type alias Model =
   , columns : Int
   , cellSize : Int
   }
<span class="gd">-type Msg = Initialize Grid | Tick Time
</span><span class="gi">+
+type Msg = Initialize Grid
+         | Tick Time
+         | Restart
</span> 
 model : Model
 model =
<span class="p">@@ -34,15 +38,14 @@</span> main =
     }
 
 init : (Model, Cmd Msg)
<span class="gd">-init =
-  (model, Random.generate
-     Initialize
-     (Random.map
-       (groupInto model.columns)
-       (Random.list (model.rows * model.columns) Random.bool)))
</span><span class="gi">+init = (model, seed model.rows model.columns)
</span> 
<span class="gd">-view : Model -&gt; Html msg
-view model = div [ ] (List.map (row model.cellSize) model.grid)
</span><span class="gi">+view : Model -&gt; Html Msg
+view model =
+  div [ ]
+    [ div [ ] [ button [ onClick Restart ] [ text "Restart Simulation" ] ]
+    , div [ ] (List.map (row model.cellSize) model.grid)
+    ]
</span> 
 update : Msg -&gt; Model -&gt; (Model, Cmd Msg)
 update msg state =
<span class="p">@@ -53,9 +56,19 @@</span> update msg state =
     Tick _ -&gt;
       ({ state | grid = evolve state }, Cmd.none)
 
<span class="gi">+    Restart -&gt;
+      (state, seed state.rows state.columns)
+
</span> subscriptions : Model -&gt; Sub Msg
 subscriptions _ = Time.every Time.second Tick
 
<span class="gi">+seed : Int -&gt; Int -&gt; Cmd Msg
+seed rows columns =
+  Random.generate Initialize
+     (Random.map
+       (groupInto columns)
+       (Random.list (rows * columns) Random.bool))
+
</span> row : Int -&gt; List Bool -&gt; Html msg
 row size row =
   div [ style [ ("clear", "both") ] ] (List.map (cell size) row)</code></pre></figure> <h2 id="controlling-grid-dimensions">Controlling Grid Dimensions</h2> <p>Now, we come to the point where the initial step of unifying the model will actually pay off. Adding this feature, again, requires changes to the imports section of the program, but otherwise simply adds code <em>without changing any that has already been written</em>. This point demands emphasis: we are able to add entirely new functionality without touching any of the pre-existing code, making our program much more robust to change than many other languages (think about how horrendous adding sliders for controlling the dimensions of the grid in JavaScript could look).</p> <p>Our additions, much like with the restart button, are of a very particular sort (expect to see this pattern again): update the <code class="language-plaintext highlighter-rouge">Msg</code> union type, write HTML to send the new message, and handle the message in the <code class="language-plaintext highlighter-rouge">update</code> function.</p> <p>This particular feature requires an <code class="language-plaintext highlighter-rouge">onChange</code> helper method, which is not supplied by the Elm HTML library. This is a consequence of the indeterminacy in the type of values produced by the change event. In this case, we want an integer, but defer handling of parsing the value ourselves until the update cycle—we could perform this type conversion during the initial event handler, but this would be an issue for two reasons. The first of which being the inability to reuse the function easily; we would need a new one if we ever wanted to handle floats. Additionally, if our type conversion fails, for any reason, we are unable to supply a reasonable default value (e.g. the current value in the state of our application).</p> <p>Another point of interest in the implementation of this simple feature is the use of an additional <code class="language-plaintext highlighter-rouge">Dimension</code> union type. A significant feature of Elm, as fas as I am concerned, is this ability to combine union types in such a way that promotes composability. While not inherently obvious from this example, it would be possible to extract a separate <code class="language-plaintext highlighter-rouge">Dimension</code> module, exposing this type, and handling various responsibilities related to dimensions of the grid. In the <code class="language-plaintext highlighter-rouge">update</code> function, we could, instead of having a nested <code class="language-plaintext highlighter-rouge">case</code> statement on the <code class="language-plaintext highlighter-rouge">Dimension</code>, call out to a function in our library, thereby reducing the verbosity of the primary update cycle and encapsulating the detailed knowledge of dimensionality.</p> <p>It is also worth noting that the <code class="language-plaintext highlighter-rouge">update</code> function for the <code class="language-plaintext highlighter-rouge">UpdateSize</code> branch makes use of the new <code class="language-plaintext highlighter-rouge">seed</code> function introduced to handle restarting the simulation. This is done to prevent a mismatch between the values of <code class="language-plaintext highlighter-rouge">rows</code> and <code class="language-plaintext highlighter-rouge">columns</code>, as compared to the size of our <code class="language-plaintext highlighter-rouge">grid</code>, in the internal instance of the <code class="language-plaintext highlighter-rouge">Model</code> structure that Elm passes around. For clarity, imagine a situation where the number of rows is updated, but not the contents of the nested list structure: this would have potential to yield nonsensical results, especially in the case where the rows are decreased below their initial value.</p> <figure class="highlight"><pre><code class="language-diff" data-lang="diff"><span class="gh">diff --git 1/_examples/elm/game_of_life_gold_plated_step2.elm 2/_examples/elm/game_of_life_gold_plated_step3.elm
index f2874ec..07ff1c3 100644
</span><span class="gd">--- 1/_examples/elm/game_of_life_gold_plated_step2.elm
</span><span class="gi">+++ 2/_examples/elm/game_of_life_gold_plated_step3.elm
</span><span class="p">@@ -5,9 +5,11 @@</span> import Random
 import Time exposing (Time)
 import Tuple exposing (first, second)
 
<span class="gd">-import Html exposing (Html, Attribute, div, label, button, text)
-import Html.Events exposing (onClick)
-import Html.Attributes exposing (style)
</span><span class="gi">+import Json.Decode as Json
+
+import Html exposing (Html, Attribute, div, label, button, input, text)
+import Html.Events exposing (onClick, on, targetValue)
+import Html.Attributes as Attr exposing (style)
</span> 
 type alias Grid = List (List Bool)
 type alias Model =
<span class="p">@@ -20,6 +22,9 @@</span> type alias Model =
 type Msg = Initialize Grid
          | Tick Time
          | Restart
<span class="gi">+         | UpdateSize Dimension String
+
+type Dimension = Rows | Columns
</span> 
 model : Model
 model =
<span class="p">@@ -44,6 +49,29 @@</span> view : Model -&gt; Html Msg
 view model =
   div [ ]
     [ div [ ] [ button [ onClick Restart ] [ text "Restart Simulation" ] ]
<span class="gi">+
+    , div [ ]
+      [ label [ ] [ text ("Grid Rows (" ++ toString model.rows ++ ")") ]
+      , input
+        [ Attr.type_ "range"
+        , Attr.value (toString model.rows)
+        , Attr.min "10"
+        , Attr.max "200"
+        , onChange (UpdateSize Rows)
+        ] [ ]
+      ]
+
+    , div [ ]
+      [ label [ ] [ text ("Grid Columns (" ++ toString model.columns ++ ")") ]
+      , input
+        [ Attr.type_ "range"
+        , Attr.value (toString model.columns)
+        , Attr.min "10"
+        , Attr.max "200"
+        , onChange (UpdateSize Columns)
+        ] [ ]
+      ]
+
</span>     , div [ ] (List.map (row model.cellSize) model.grid)
     ]
 
<span class="p">@@ -59,6 +87,20 @@</span> update msg state =
     Restart -&gt;
       (state, seed state.rows state.columns)
 
<span class="gi">+    UpdateSize dim size -&gt;
+      case dim of
+        Rows -&gt;
+          let
+            rows = Result.withDefault state.rows (String.toInt size)
+          in
+            ({ state | rows = rows }, seed rows state.columns)
+
+        Columns -&gt;
+          let
+            columns = Result.withDefault state.columns (String.toInt size)
+          in
+            ({ state | columns = columns }, seed state.rows columns)
+
</span> subscriptions : Model -&gt; Sub Msg
 subscriptions _ = Time.every Time.second Tick
 
<span class="p">@@ -85,6 +127,10 @@</span> cellStyle cellSize on =
     , ("float", "left")
     ]
 
<span class="gi">+onChange : (String -&gt; msg) -&gt; Attribute msg
+onChange tagger =
+  on "change" (Json.map tagger targetValue)
+
</span> groupInto : Int -&gt; List a -&gt; List (List a)
 groupInto n lst =
   if List.length lst == 0 then</code></pre></figure> <h2 id="population-density">Population Density</h2> <p>The ability to change the density of cells in the active state when reseeding the grid fits perfectly within the purview of gold plating, so we should add that feature, as well. The basic pattern, as seen in the previous two examples, remains the same and will not be elaborated upon.</p> <p>Instead, we should consider how our earlier decision to keep the <code class="language-plaintext highlighter-rouge">onChange</code> function generic has allowed its reuse in this implementation. Our new feature, however, does have a much larger footprint than others, since the <code class="language-plaintext highlighter-rouge">density</code> field must be propagated through any call to the <code class="language-plaintext highlighter-rouge">seed</code> function. An alternative function signature would simply take the model, rather than three fields therefrom, but that is a point which could be argued either way and would not decrease the footprint of this change.</p> <p>We also rewrite the <code class="language-plaintext highlighter-rouge">seed</code> function, in light of its additional complexity, using <span class="fancylink"> <a href="http://package.elm-lang.org/packages/elm-lang/core/5.1.1/Basics#|%3E">forward function application</a> <span> <a href="http://package.elm-lang.org/packages/elm-lang/core/5.1.1/Basics#|%3E" target="_blank" alt="Pop Out" title="Pop Out"><svg class="octicon octicon-link-external" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> </span> </span>, for improved legibility.</p> <figure class="highlight"><pre><code class="language-diff" data-lang="diff"><span class="gh">diff --git 1/_examples/elm/game_of_life_gold_plated_step3.elm 2/_examples/elm/game_of_life_gold_plated_step4.elm
index 07ff1c3..944ed9e 100644
</span><span class="gd">--- 1/_examples/elm/game_of_life_gold_plated_step3.elm
</span><span class="gi">+++ 2/_examples/elm/game_of_life_gold_plated_step4.elm
</span><span class="p">@@ -17,12 +17,14 @@</span> type alias Model =
   , rows : Int
   , columns : Int
   , cellSize : Int
<span class="gi">+  , density : Float
</span>   }
 
 type Msg = Initialize Grid
          | Tick Time
          | Restart
          | UpdateSize Dimension String
<span class="gi">+         | UpdateDensity String
</span> 
 type Dimension = Rows | Columns
 
<span class="p">@@ -32,6 +34,7 @@</span> model =
   , cellSize = 5
   , columns = 35
   , rows = 35
<span class="gi">+  , density = 0.5
</span>   }
 
 main =
<span class="p">@@ -43,7 +46,7 @@</span> main =
     }
 
 init : (Model, Cmd Msg)
<span class="gd">-init = (model, seed model.rows model.columns)
</span><span class="gi">+init = (model, seed model.rows model.columns model.density)
</span> 
 view : Model -&gt; Html Msg
 view model =
<span class="p">@@ -72,6 +75,18 @@</span> view model =
         ] [ ]
       ]
 
<span class="gi">+    , div [ ]
+      [ label [ ] [ text ("Population Density (" ++ toString model.density ++ ")") ]
+      , input
+        [ Attr.type_ "range"
+        , Attr.value (toString model.density)
+        , Attr.min "0"
+        , Attr.max "1"
+        , Attr.step ".01"
+        , onChange UpdateDensity
+        ] [ ]
+      ]
+
</span>     , div [ ] (List.map (row model.cellSize) model.grid)
     ]
 
<span class="p">@@ -85,7 +100,7 @@</span> update msg state =
       ({ state | grid = evolve state }, Cmd.none)
 
     Restart -&gt;
<span class="gd">-      (state, seed state.rows state.columns)
</span><span class="gi">+      (state, seed state.rows state.columns state.density)
</span> 
     UpdateSize dim size -&gt;
       case dim of
<span class="p">@@ -93,23 +108,29 @@</span> update msg state =
           let
             rows = Result.withDefault state.rows (String.toInt size)
           in
<span class="gd">-            ({ state | rows = rows }, seed rows state.columns)
</span><span class="gi">+            ({ state | rows = rows }, seed rows state.columns state.density)
</span> 
         Columns -&gt;
           let
             columns = Result.withDefault state.columns (String.toInt size)
           in
<span class="gd">-            ({ state | columns = columns }, seed state.rows columns)
</span><span class="gi">+            ({ state | columns = columns }, seed state.rows columns state.density)
+
+    UpdateDensity val -&gt;
+      let
+        density = Result.withDefault state.density (String.toFloat val)
+      in
+        ({ state | density = density }, seed state.rows state.columns density)
</span> 
 subscriptions : Model -&gt; Sub Msg
 subscriptions _ = Time.every Time.second Tick
 
<span class="gd">-seed : Int -&gt; Int -&gt; Cmd Msg
-seed rows columns =
-  Random.generate Initialize
-     (Random.map
-       (groupInto columns)
-       (Random.list (rows * columns) Random.bool))
</span><span class="gi">+seed : Int -&gt; Int -&gt; Float -&gt; Cmd Msg
+seed rows columns density =
+  Random.map (\n -&gt; n &lt; density) (Random.float 0 1)
+    |&gt; Random.list (rows * columns)
+    |&gt; Random.map (groupInto columns)
+    |&gt; Random.generate Initialize
</span> 
 row : Int -&gt; List Bool -&gt; Html msg
 row size row =</code></pre></figure> <h2 id="controlling-tick-rate">Controlling Tick Rate</h2> <p>Changing the speed at which the simulation runs is as simple as can be. Following the, by now, well established pattern, we can do so in just a few short lines. If anything, the use of additional functions from the <code class="language-plaintext highlighter-rouge">Time</code> module are interesting.</p> <figure class="highlight"><pre><code class="language-diff" data-lang="diff"><span class="gh">diff --git 1/_examples/elm/game_of_life_gold_plated_step4.elm 2/_examples/elm/game_of_life_gold_plated_step5.elm
index 944ed9e..3ff7ae6 100644
</span><span class="gd">--- 1/_examples/elm/game_of_life_gold_plated_step4.elm
</span><span class="gi">+++ 2/_examples/elm/game_of_life_gold_plated_step5.elm
</span><span class="p">@@ -18,6 +18,7 @@</span> type alias Model =
   , columns : Int
   , cellSize : Int
   , density : Float
<span class="gi">+  , tickRate : Int
</span>   }
 
 type Msg = Initialize Grid
<span class="p">@@ -25,6 +26,7 @@</span> type Msg = Initialize Grid
          | Restart
          | UpdateSize Dimension String
          | UpdateDensity String
<span class="gi">+         | UpdateTickRate String
</span> 
 type Dimension = Rows | Columns
 
<span class="p">@@ -35,6 +37,7 @@</span> model =
   , columns = 35
   , rows = 35
   , density = 0.5
<span class="gi">+  , tickRate = 1
</span>   }
 
 main =
<span class="p">@@ -87,6 +90,18 @@</span> view model =
         ] [ ]
       ]
 
<span class="gi">+    , div [ ]
+      [ label [ ] [ text ("Tick Rate (" ++ toString model.tickRate ++ " hz)") ]
+      , input
+        [ Attr.type_ "range"
+        , Attr.value (toString model.tickRate)
+        , Attr.min "1"
+        , Attr.max "10"
+        , Attr.step "1"
+        , onChange UpdateTickRate
+        ] [ ]
+      ]
+
</span>     , div [ ] (List.map (row model.cellSize) model.grid)
     ]
 
<span class="p">@@ -122,8 +137,15 @@</span> update msg state =
       in
         ({ state | density = density }, seed state.rows state.columns density)
 
<span class="gi">+    UpdateTickRate val -&gt;
+      let
+        tickRate = Result.withDefault state.tickRate (String.toInt val)
+      in
+        ({ state | tickRate = tickRate }, Cmd.none)
+
</span> subscriptions : Model -&gt; Sub Msg
<span class="gd">-subscriptions _ = Time.every Time.second Tick
</span><span class="gi">+subscriptions state =
+  Time.every (Time.millisecond * (1000 / (toFloat state.tickRate))) Tick
</span> 
 seed : Int -&gt; Int -&gt; Float -&gt; Cmd Msg
 seed rows columns density =</code></pre></figure> <h2 id="mouse-reactivity">Mouse Reactivity</h2> <p>Having reached a point where new functionality, of a kind, is as trivial to add as possible, we will now move on to adding a slightly different feature. In this case, we will set any cell moused over to the on state.</p> <p>This change affects a larger footprint, but is still fairly well contained. We need to pass <code class="language-plaintext highlighter-rouge">Int</code> values for row and column through the <code class="language-plaintext highlighter-rouge">row</code> and <code class="language-plaintext highlighter-rouge">cell</code> functions, such that the latter is able to add them to the <code class="language-plaintext highlighter-rouge">onMouseOver</code> attribute for the divs of individual cells.</p> <p>We also need to write a, rather kludgy <code class="language-plaintext highlighter-rouge">setAt</code> helper function, for updating an item at an arbitrary point in our nested list. We will discuss some implications revealed by this, seemingly tangential aspect, shortly</p> <figure class="highlight"><pre><code class="language-diff" data-lang="diff"><span class="gh">diff --git 1/_examples/elm/game_of_life_gold_plated_step5.elm 2/_examples/elm/game_of_life_gold_plated.elm
index 3ff7ae6..8689a89 100644
</span><span class="gd">--- 1/_examples/elm/game_of_life_gold_plated_step5.elm
</span><span class="gi">+++ 2/_examples/elm/game_of_life_gold_plated.elm
</span><span class="p">@@ -8,7 +8,7 @@</span> import Tuple exposing (first, second)
 import Json.Decode as Json
 
 import Html exposing (Html, Attribute, div, label, button, input, text)
<span class="gd">-import Html.Events exposing (onClick, on, targetValue)
</span><span class="gi">+import Html.Events exposing (onClick, onMouseOut, on, targetValue)
</span> import Html.Attributes as Attr exposing (style)
 
 type alias Grid = List (List Bool)
<span class="p">@@ -27,6 +27,7 @@</span> type Msg = Initialize Grid
          | UpdateSize Dimension String
          | UpdateDensity String
          | UpdateTickRate String
<span class="gi">+         | ToggleCell Int Int
</span> 
 type Dimension = Rows | Columns
 
<span class="p">@@ -102,7 +103,7 @@</span> view model =
         ] [ ]
       ]
 
<span class="gd">-    , div [ ] (List.map (row model.cellSize) model.grid)
</span><span class="gi">+    , div [ ] (List.indexedMap (row model.cellSize) model.grid)
</span>     ]
 
 update : Msg -&gt; Model -&gt; (Model, Cmd Msg)
<span class="p">@@ -143,6 +144,9 @@</span> update msg state =
       in
         ({ state | tickRate = tickRate }, Cmd.none)
 
<span class="gi">+    ToggleCell x y -&gt;
+      ({ state | grid = setAt x y True state.grid }, Cmd.none)
+
</span> subscriptions : Model -&gt; Sub Msg
 subscriptions state =
   Time.every (Time.millisecond * (1000 / (toFloat state.tickRate))) Tick
<span class="p">@@ -154,12 +158,19 @@</span> seed rows columns density =
     |&gt; Random.map (groupInto columns)
     |&gt; Random.generate Initialize
 
<span class="gd">-row : Int -&gt; List Bool -&gt; Html msg
-row size row =
-  div [ style [ ("clear", "both") ] ] (List.map (cell size) row)
</span><span class="gi">+row : Int -&gt; Int -&gt; List Bool -&gt; Html Msg
+row size column row =
+  div
+    [ style [ ("clear", "both") ] ]
+    (List.indexedMap (cell size column) row)
</span> 
<span class="gd">-cell : Int -&gt; Bool -&gt; Html msg
-cell size on = div [ cellStyle size on ] [ text " " ]
</span><span class="gi">+cell : Int -&gt; Int -&gt; Int -&gt; Bool -&gt; Html Msg
+cell size x y on =
+  div
+    [ cellStyle size on
+    , onMouseOut (ToggleCell x y)
+    ]
+    [ text " " ]
</span> 
 cellStyle : Int -&gt; Bool -&gt; Attribute msg
 cellStyle cellSize on =
<span class="p">@@ -203,3 +214,11 @@</span> descend {grid, rows, columns} x y =
 valueAt : Int -&gt; a -&gt; List a -&gt; a
 valueAt i default lst =
   Maybe.withDefault default (List.head (List.drop i lst))
<span class="gi">+
+setAt : Int -&gt; Int -&gt; a -&gt; List (List a) -&gt; List (List a)
+setAt x y val lst =
+  let
+    inner = valueAt x [] lst
+    updated = (List.take y inner) ++ (val :: (List.drop (y + 1) inner))
+  in
+    (List.take x lst) ++ (updated :: List.drop (x + 1) lst)</span></code></pre></figure> <h2 id="discussion">Discussion</h2> <p>At long last, behold the full example before we discuss it in more detail:</p> <section class="example-embed"> <h4>game_of_life_gold_plated.elm</h4> <h5>Source</h5> <figure class="highlight"><pre><code class="language-elm" data-lang="elm"><span class="k">import</span> <span class="kt">List</span>
<span class="k">import</span> <span class="kt">Random</span>
<span class="k">import</span> <span class="kt">Time</span> <span class="k">exposing</span> <span class="p">(</span><span class="kt">Time</span><span class="p">)</span>
<span class="k">import</span> <span class="kt">Tuple</span> <span class="k">exposing</span> <span class="p">(</span><span class="n">first</span><span class="o">,</span> <span class="n">second</span><span class="p">)</span>

<span class="k">import</span> <span class="kt">Json</span><span class="o">.</span><span class="kt">Decode</span> <span class="k">as</span> <span class="kt">Json</span>

<span class="k">import</span> <span class="kt">Html</span> <span class="k">exposing</span> <span class="p">(</span><span class="kt">Html</span><span class="o">,</span> <span class="kt">Attribute</span><span class="o">,</span> <span class="n">div</span><span class="o">,</span> <span class="n">label</span><span class="o">,</span> <span class="n">button</span><span class="o">,</span> <span class="n">input</span><span class="o">,</span> <span class="n">text</span><span class="p">)</span>
<span class="k">import</span> <span class="kt">Html</span><span class="o">.</span><span class="kt">Events</span> <span class="k">exposing</span> <span class="p">(</span><span class="n">onClick</span><span class="o">,</span> <span class="n">onMouseOut</span><span class="o">,</span> <span class="n">on</span><span class="o">,</span> <span class="n">targetValue</span><span class="p">)</span>
<span class="k">import</span> <span class="kt">Html</span><span class="o">.</span><span class="kt">Attributes</span> <span class="k">as</span> <span class="kt">Attr</span> <span class="k">exposing</span> <span class="p">(</span><span class="n">style</span><span class="p">)</span>

<span class="k">type</span> <span class="k">alias</span> <span class="kt">Grid</span> <span class="o">=</span> <span class="kt">List</span> <span class="p">(</span><span class="kt">List</span> <span class="kt">Bool</span><span class="p">)</span>
<span class="k">type</span> <span class="k">alias</span> <span class="kt">Model</span> <span class="o">=</span>
  <span class="p">{</span> <span class="n">grid</span> <span class="p">:</span> <span class="kt">Grid</span>
  <span class="o">,</span> <span class="n">rows</span> <span class="p">:</span> <span class="kt">Int</span>
  <span class="o">,</span> <span class="n">columns</span> <span class="p">:</span> <span class="kt">Int</span>
  <span class="o">,</span> <span class="n">cellSize</span> <span class="p">:</span> <span class="kt">Int</span>
  <span class="o">,</span> <span class="n">density</span> <span class="p">:</span> <span class="kt">Float</span>
  <span class="o">,</span> <span class="n">tickRate</span> <span class="p">:</span> <span class="kt">Int</span>
  <span class="p">}</span>

<span class="k">type</span> <span class="kt">Msg</span> <span class="o">=</span> <span class="kt">Initialize</span> <span class="kt">Grid</span>
         <span class="o">|</span> <span class="kt">Tick</span> <span class="kt">Time</span>
         <span class="o">|</span> <span class="kt">Restart</span>
         <span class="o">|</span> <span class="kt">UpdateSize</span> <span class="kt">Dimension</span> <span class="kt">String</span>
         <span class="o">|</span> <span class="kt">UpdateDensity</span> <span class="kt">String</span>
         <span class="o">|</span> <span class="kt">UpdateTickRate</span> <span class="kt">String</span>
         <span class="o">|</span> <span class="kt">ToggleCell</span> <span class="kt">Int</span> <span class="kt">Int</span>

<span class="k">type</span> <span class="kt">Dimension</span> <span class="o">=</span> <span class="kt">Rows</span> <span class="o">|</span> <span class="kt">Columns</span>

<span class="n">model</span> <span class="p">:</span> <span class="kt">Model</span>
<span class="n">model</span> <span class="o">=</span>
  <span class="p">{</span> <span class="n">grid</span> <span class="o">=</span> <span class="p">[[]]</span>
  <span class="o">,</span> <span class="n">cellSize</span> <span class="o">=</span> <span class="mi">5</span>
  <span class="o">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="mi">35</span>
  <span class="o">,</span> <span class="n">rows</span> <span class="o">=</span> <span class="mi">35</span>
  <span class="o">,</span> <span class="n">density</span> <span class="o">=</span> <span class="mf">0.5</span>
  <span class="o">,</span> <span class="n">tickRate</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="p">}</span>

<span class="n">main</span> <span class="o">=</span>
  <span class="kt">Html</span><span class="o">.</span><span class="n">program</span>
    <span class="p">{</span> <span class="n">init</span> <span class="o">=</span> <span class="n">init</span>
    <span class="o">,</span> <span class="n">view</span> <span class="o">=</span> <span class="n">view</span>
    <span class="o">,</span> <span class="n">update</span> <span class="o">=</span> <span class="n">update</span>
    <span class="o">,</span> <span class="n">subscriptions</span> <span class="o">=</span> <span class="n">subscriptions</span>
    <span class="p">}</span>

<span class="n">init</span> <span class="p">:</span> <span class="p">(</span><span class="kt">Model</span><span class="o">,</span> <span class="kt">Cmd</span> <span class="kt">Msg</span><span class="p">)</span>
<span class="n">init</span> <span class="o">=</span> <span class="p">(</span><span class="n">model</span><span class="o">,</span> <span class="n">seed</span> <span class="n">model</span><span class="o">.</span><span class="n">rows</span> <span class="n">model</span><span class="o">.</span><span class="n">columns</span> <span class="n">model</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>

<span class="n">view</span> <span class="p">:</span> <span class="kt">Model</span> <span class="o">-&gt;</span> <span class="kt">Html</span> <span class="kt">Msg</span>
<span class="n">view</span> <span class="n">model</span> <span class="o">=</span>
  <span class="n">div</span> <span class="p">[</span> <span class="p">]</span>
    <span class="p">[</span> <span class="n">div</span> <span class="p">[</span> <span class="p">]</span> <span class="p">[</span> <span class="n">button</span> <span class="p">[</span> <span class="n">onClick</span> <span class="kt">Restart</span> <span class="p">]</span> <span class="p">[</span> <span class="n">text</span> <span class="s">"</span><span class="s2">Restart Simulation"</span> <span class="p">]</span> <span class="p">]</span>

    <span class="o">,</span> <span class="n">div</span> <span class="p">[</span> <span class="p">]</span>
      <span class="p">[</span> <span class="n">label</span> <span class="p">[</span> <span class="p">]</span> <span class="p">[</span> <span class="n">text</span> <span class="p">(</span><span class="s">"</span><span class="s2">Grid Rows ("</span> <span class="o">++</span> <span class="n">toString</span> <span class="n">model</span><span class="o">.</span><span class="n">rows</span> <span class="o">++</span> <span class="s">"</span><span class="s2">)"</span><span class="p">)</span> <span class="p">]</span>
      <span class="o">,</span> <span class="n">input</span>
        <span class="p">[</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">type_</span> <span class="s">"</span><span class="s2">range"</span>
        <span class="o">,</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">value</span> <span class="p">(</span><span class="n">toString</span> <span class="n">model</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span>
        <span class="o">,</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">min</span> <span class="s">"</span><span class="s2">10"</span>
        <span class="o">,</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">max</span> <span class="s">"</span><span class="s2">200"</span>
        <span class="o">,</span> <span class="n">onChange</span> <span class="p">(</span><span class="kt">UpdateSize</span> <span class="kt">Rows</span><span class="p">)</span>
        <span class="p">]</span> <span class="p">[</span> <span class="p">]</span>
      <span class="p">]</span>

    <span class="o">,</span> <span class="n">div</span> <span class="p">[</span> <span class="p">]</span>
      <span class="p">[</span> <span class="n">label</span> <span class="p">[</span> <span class="p">]</span> <span class="p">[</span> <span class="n">text</span> <span class="p">(</span><span class="s">"</span><span class="s2">Grid Columns ("</span> <span class="o">++</span> <span class="n">toString</span> <span class="n">model</span><span class="o">.</span><span class="n">columns</span> <span class="o">++</span> <span class="s">"</span><span class="s2">)"</span><span class="p">)</span> <span class="p">]</span>
      <span class="o">,</span> <span class="n">input</span>
        <span class="p">[</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">type_</span> <span class="s">"</span><span class="s2">range"</span>
        <span class="o">,</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">value</span> <span class="p">(</span><span class="n">toString</span> <span class="n">model</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
        <span class="o">,</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">min</span> <span class="s">"</span><span class="s2">10"</span>
        <span class="o">,</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">max</span> <span class="s">"</span><span class="s2">200"</span>
        <span class="o">,</span> <span class="n">onChange</span> <span class="p">(</span><span class="kt">UpdateSize</span> <span class="kt">Columns</span><span class="p">)</span>
        <span class="p">]</span> <span class="p">[</span> <span class="p">]</span>
      <span class="p">]</span>

    <span class="o">,</span> <span class="n">div</span> <span class="p">[</span> <span class="p">]</span>
      <span class="p">[</span> <span class="n">label</span> <span class="p">[</span> <span class="p">]</span> <span class="p">[</span> <span class="n">text</span> <span class="p">(</span><span class="s">"</span><span class="s2">Population Density ("</span> <span class="o">++</span> <span class="n">toString</span> <span class="n">model</span><span class="o">.</span><span class="n">density</span> <span class="o">++</span> <span class="s">"</span><span class="s2">)"</span><span class="p">)</span> <span class="p">]</span>
      <span class="o">,</span> <span class="n">input</span>
        <span class="p">[</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">type_</span> <span class="s">"</span><span class="s2">range"</span>
        <span class="o">,</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">value</span> <span class="p">(</span><span class="n">toString</span> <span class="n">model</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>
        <span class="o">,</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">min</span> <span class="s">"</span><span class="s2">0"</span>
        <span class="o">,</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">max</span> <span class="s">"</span><span class="s2">1"</span>
        <span class="o">,</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">step</span> <span class="s">"</span><span class="s2">.01"</span>
        <span class="o">,</span> <span class="n">onChange</span> <span class="kt">UpdateDensity</span>
        <span class="p">]</span> <span class="p">[</span> <span class="p">]</span>
      <span class="p">]</span>

    <span class="o">,</span> <span class="n">div</span> <span class="p">[</span> <span class="p">]</span>
      <span class="p">[</span> <span class="n">label</span> <span class="p">[</span> <span class="p">]</span> <span class="p">[</span> <span class="n">text</span> <span class="p">(</span><span class="s">"</span><span class="s2">Tick Rate ("</span> <span class="o">++</span> <span class="n">toString</span> <span class="n">model</span><span class="o">.</span><span class="n">tickRate</span> <span class="o">++</span> <span class="s">"</span><span class="s2"> hz)"</span><span class="p">)</span> <span class="p">]</span>
      <span class="o">,</span> <span class="n">input</span>
        <span class="p">[</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">type_</span> <span class="s">"</span><span class="s2">range"</span>
        <span class="o">,</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">value</span> <span class="p">(</span><span class="n">toString</span> <span class="n">model</span><span class="o">.</span><span class="n">tickRate</span><span class="p">)</span>
        <span class="o">,</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">min</span> <span class="s">"</span><span class="s2">1"</span>
        <span class="o">,</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">max</span> <span class="s">"</span><span class="s2">10"</span>
        <span class="o">,</span> <span class="kt">Attr</span><span class="o">.</span><span class="n">step</span> <span class="s">"</span><span class="s2">1"</span>
        <span class="o">,</span> <span class="n">onChange</span> <span class="kt">UpdateTickRate</span>
        <span class="p">]</span> <span class="p">[</span> <span class="p">]</span>
      <span class="p">]</span>

    <span class="o">,</span> <span class="n">div</span> <span class="p">[</span> <span class="p">]</span> <span class="p">(</span><span class="kt">List</span><span class="o">.</span><span class="n">indexedMap</span> <span class="p">(</span><span class="n">row</span> <span class="n">model</span><span class="o">.</span><span class="n">cellSize</span><span class="p">)</span> <span class="n">model</span><span class="o">.</span><span class="n">grid</span><span class="p">)</span>
    <span class="p">]</span>

<span class="n">update</span> <span class="p">:</span> <span class="kt">Msg</span> <span class="o">-&gt;</span> <span class="kt">Model</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="kt">Model</span><span class="o">,</span> <span class="kt">Cmd</span> <span class="kt">Msg</span><span class="p">)</span>
<span class="n">update</span> <span class="n">msg</span> <span class="n">state</span> <span class="o">=</span>
  <span class="k">case</span> <span class="n">msg</span> <span class="k">of</span>
    <span class="kt">Initialize</span> <span class="n">initial</span> <span class="o">-&gt;</span>
      <span class="p">({</span> <span class="n">state</span> <span class="o">|</span> <span class="n">grid</span> <span class="o">=</span> <span class="n">initial</span> <span class="p">}</span><span class="o">,</span> <span class="kt">Cmd</span><span class="o">.</span><span class="n">none</span><span class="p">)</span>

    <span class="kt">Tick</span> <span class="n">_</span> <span class="o">-&gt;</span>
      <span class="p">({</span> <span class="n">state</span> <span class="o">|</span> <span class="n">grid</span> <span class="o">=</span> <span class="n">evolve</span> <span class="n">state</span> <span class="p">}</span><span class="o">,</span> <span class="kt">Cmd</span><span class="o">.</span><span class="n">none</span><span class="p">)</span>

    <span class="kt">Restart</span> <span class="o">-&gt;</span>
      <span class="p">(</span><span class="n">state</span><span class="o">,</span> <span class="n">seed</span> <span class="n">state</span><span class="o">.</span><span class="n">rows</span> <span class="n">state</span><span class="o">.</span><span class="n">columns</span> <span class="n">state</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>

    <span class="kt">UpdateSize</span> <span class="n">dim</span> <span class="n">size</span> <span class="o">-&gt;</span>
      <span class="k">case</span> <span class="n">dim</span> <span class="k">of</span>
        <span class="kt">Rows</span> <span class="o">-&gt;</span>
          <span class="k">let</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="kt">Result</span><span class="o">.</span><span class="n">withDefault</span> <span class="n">state</span><span class="o">.</span><span class="n">rows</span> <span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="n">toInt</span> <span class="n">size</span><span class="p">)</span>
          <span class="k">in</span>
            <span class="p">({</span> <span class="n">state</span> <span class="o">|</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">rows</span> <span class="p">}</span><span class="o">,</span> <span class="n">seed</span> <span class="n">rows</span> <span class="n">state</span><span class="o">.</span><span class="n">columns</span> <span class="n">state</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>

        <span class="kt">Columns</span> <span class="o">-&gt;</span>
          <span class="k">let</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="kt">Result</span><span class="o">.</span><span class="n">withDefault</span> <span class="n">state</span><span class="o">.</span><span class="n">columns</span> <span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="n">toInt</span> <span class="n">size</span><span class="p">)</span>
          <span class="k">in</span>
            <span class="p">({</span> <span class="n">state</span> <span class="o">|</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span> <span class="p">}</span><span class="o">,</span> <span class="n">seed</span> <span class="n">state</span><span class="o">.</span><span class="n">rows</span> <span class="n">columns</span> <span class="n">state</span><span class="o">.</span><span class="n">density</span><span class="p">)</span>

    <span class="kt">UpdateDensity</span> <span class="n">val</span> <span class="o">-&gt;</span>
      <span class="k">let</span>
        <span class="n">density</span> <span class="o">=</span> <span class="kt">Result</span><span class="o">.</span><span class="n">withDefault</span> <span class="n">state</span><span class="o">.</span><span class="n">density</span> <span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="n">toFloat</span> <span class="n">val</span><span class="p">)</span>
      <span class="k">in</span>
        <span class="p">({</span> <span class="n">state</span> <span class="o">|</span> <span class="n">density</span> <span class="o">=</span> <span class="n">density</span> <span class="p">}</span><span class="o">,</span> <span class="n">seed</span> <span class="n">state</span><span class="o">.</span><span class="n">rows</span> <span class="n">state</span><span class="o">.</span><span class="n">columns</span> <span class="n">density</span><span class="p">)</span>

    <span class="kt">UpdateTickRate</span> <span class="n">val</span> <span class="o">-&gt;</span>
      <span class="k">let</span>
        <span class="n">tickRate</span> <span class="o">=</span> <span class="kt">Result</span><span class="o">.</span><span class="n">withDefault</span> <span class="n">state</span><span class="o">.</span><span class="n">tickRate</span> <span class="p">(</span><span class="kt">String</span><span class="o">.</span><span class="n">toInt</span> <span class="n">val</span><span class="p">)</span>
      <span class="k">in</span>
        <span class="p">({</span> <span class="n">state</span> <span class="o">|</span> <span class="n">tickRate</span> <span class="o">=</span> <span class="n">tickRate</span> <span class="p">}</span><span class="o">,</span> <span class="kt">Cmd</span><span class="o">.</span><span class="n">none</span><span class="p">)</span>

    <span class="kt">ToggleCell</span> <span class="n">x</span> <span class="n">y</span> <span class="o">-&gt;</span>
      <span class="p">({</span> <span class="n">state</span> <span class="o">|</span> <span class="n">grid</span> <span class="o">=</span> <span class="n">setAt</span> <span class="n">x</span> <span class="n">y</span> <span class="kt">True</span> <span class="n">state</span><span class="o">.</span><span class="n">grid</span> <span class="p">}</span><span class="o">,</span> <span class="kt">Cmd</span><span class="o">.</span><span class="n">none</span><span class="p">)</span>

<span class="n">subscriptions</span> <span class="p">:</span> <span class="kt">Model</span> <span class="o">-&gt;</span> <span class="kt">Sub</span> <span class="kt">Msg</span>
<span class="n">subscriptions</span> <span class="n">state</span> <span class="o">=</span>
  <span class="kt">Time</span><span class="o">.</span><span class="n">every</span> <span class="p">(</span><span class="kt">Time</span><span class="o">.</span><span class="n">millisecond</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">/</span> <span class="p">(</span><span class="n">toFloat</span> <span class="n">state</span><span class="o">.</span><span class="n">tickRate</span><span class="p">)))</span> <span class="kt">Tick</span>

<span class="n">seed</span> <span class="p">:</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">Float</span> <span class="o">-&gt;</span> <span class="kt">Cmd</span> <span class="kt">Msg</span>
<span class="n">seed</span> <span class="n">rows</span> <span class="n">columns</span> <span class="n">density</span> <span class="o">=</span>
  <span class="kt">Random</span><span class="o">.</span><span class="n">map</span> <span class="p">(</span><span class="o">\</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="n">density</span><span class="p">)</span> <span class="p">(</span><span class="kt">Random</span><span class="o">.</span><span class="n">float</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">)</span>
    <span class="o">|&gt;</span> <span class="kt">Random</span><span class="o">.</span><span class="n">list</span> <span class="p">(</span><span class="n">rows</span> <span class="o">*</span> <span class="n">columns</span><span class="p">)</span>
    <span class="o">|&gt;</span> <span class="kt">Random</span><span class="o">.</span><span class="n">map</span> <span class="p">(</span><span class="n">groupInto</span> <span class="n">columns</span><span class="p">)</span>
    <span class="o">|&gt;</span> <span class="kt">Random</span><span class="o">.</span><span class="n">generate</span> <span class="kt">Initialize</span>

<span class="n">row</span> <span class="p">:</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">List</span> <span class="kt">Bool</span> <span class="o">-&gt;</span> <span class="kt">Html</span> <span class="kt">Msg</span>
<span class="n">row</span> <span class="n">size</span> <span class="n">column</span> <span class="n">row</span> <span class="o">=</span>
  <span class="n">div</span>
    <span class="p">[</span> <span class="n">style</span> <span class="p">[</span> <span class="p">(</span><span class="s">"</span><span class="s2">clear"</span><span class="o">,</span> <span class="s">"</span><span class="s2">both"</span><span class="p">)</span> <span class="p">]</span> <span class="p">]</span>
    <span class="p">(</span><span class="kt">List</span><span class="o">.</span><span class="n">indexedMap</span> <span class="p">(</span><span class="n">cell</span> <span class="n">size</span> <span class="n">column</span><span class="p">)</span> <span class="n">row</span><span class="p">)</span>

<span class="n">cell</span> <span class="p">:</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="o">-&gt;</span> <span class="kt">Html</span> <span class="kt">Msg</span>
<span class="n">cell</span> <span class="n">size</span> <span class="n">x</span> <span class="n">y</span> <span class="n">on</span> <span class="o">=</span>
  <span class="n">div</span>
    <span class="p">[</span> <span class="n">cellStyle</span> <span class="n">size</span> <span class="n">on</span>
    <span class="o">,</span> <span class="n">onMouseOut</span> <span class="p">(</span><span class="kt">ToggleCell</span> <span class="n">x</span> <span class="n">y</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="p">[</span> <span class="n">text</span> <span class="s">"</span><span class="s2"> "</span> <span class="p">]</span>

<span class="n">cellStyle</span> <span class="p">:</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="o">-&gt;</span> <span class="kt">Attribute</span> <span class="n">msg</span>
<span class="n">cellStyle</span> <span class="n">cellSize</span> <span class="n">on</span> <span class="o">=</span>
  <span class="n">style</span>
    <span class="p">[</span> <span class="p">(</span><span class="s">"</span><span class="s2">background"</span><span class="o">,</span> <span class="k">if</span> <span class="n">on</span> <span class="k">then</span> <span class="s">"</span><span class="s2">black"</span> <span class="k">else</span> <span class="s">"</span><span class="s2">white"</span><span class="p">)</span>
    <span class="o">,</span> <span class="p">(</span><span class="s">"</span><span class="s2">width"</span><span class="o">,</span> <span class="n">toString</span> <span class="n">cellSize</span> <span class="o">++</span> <span class="s">"</span><span class="s2">px"</span><span class="p">)</span>
    <span class="o">,</span> <span class="p">(</span><span class="s">"</span><span class="s2">height"</span><span class="o">,</span> <span class="n">toString</span> <span class="n">cellSize</span> <span class="o">++</span> <span class="s">"</span><span class="s2">px"</span><span class="p">)</span>
    <span class="o">,</span> <span class="p">(</span><span class="s">"</span><span class="s2">float"</span><span class="o">,</span> <span class="s">"</span><span class="s2">left"</span><span class="p">)</span>
    <span class="p">]</span>

<span class="n">onChange</span> <span class="p">:</span> <span class="p">(</span><span class="kt">String</span> <span class="o">-&gt;</span> <span class="n">msg</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Attribute</span> <span class="n">msg</span>
<span class="n">onChange</span> <span class="n">tagger</span> <span class="o">=</span>
  <span class="n">on</span> <span class="s">"</span><span class="s2">change"</span> <span class="p">(</span><span class="kt">Json</span><span class="o">.</span><span class="n">map</span> <span class="n">tagger</span> <span class="n">targetValue</span><span class="p">)</span>

<span class="n">groupInto</span> <span class="p">:</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">List</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">List</span> <span class="p">(</span><span class="kt">List</span> <span class="n">a</span><span class="p">)</span>
<span class="n">groupInto</span> <span class="n">n</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="k">if</span> <span class="kt">List</span><span class="o">.</span><span class="n">length</span> <span class="n">lst</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">then</span>
    <span class="p">[]</span>
  <span class="k">else</span>
    <span class="p">(</span><span class="kt">List</span><span class="o">.</span><span class="n">take</span> <span class="n">n</span> <span class="n">lst</span><span class="p">)</span> <span class="o">::</span> <span class="p">(</span><span class="n">groupInto</span> <span class="n">n</span> <span class="p">(</span><span class="kt">List</span><span class="o">.</span><span class="n">drop</span> <span class="n">n</span> <span class="n">lst</span><span class="p">))</span>

<span class="n">evolve</span> <span class="p">:</span> <span class="kt">Model</span> <span class="o">-&gt;</span> <span class="kt">Grid</span>
<span class="n">evolve</span> <span class="p">({</span><span class="n">grid</span><span class="p">}</span> <span class="k">as</span> <span class="n">model</span><span class="p">)</span> <span class="o">=</span>
  <span class="kt">List</span><span class="o">.</span><span class="n">indexedMap</span> <span class="p">(</span><span class="o">\</span><span class="n">y</span> <span class="n">row</span> <span class="o">-&gt;</span>
    <span class="kt">List</span><span class="o">.</span><span class="n">indexedMap</span> <span class="p">(</span><span class="o">\</span><span class="n">x</span> <span class="n">_</span> <span class="o">-&gt;</span>
      <span class="n">descend</span> <span class="n">model</span> <span class="n">x</span> <span class="n">y</span><span class="p">)</span> <span class="n">row</span><span class="p">)</span> <span class="n">grid</span>

<span class="n">descend</span> <span class="p">:</span> <span class="kt">Model</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">Bool</span>
<span class="n">descend</span> <span class="p">{</span><span class="n">grid</span><span class="o">,</span> <span class="n">rows</span><span class="o">,</span> <span class="n">columns</span><span class="p">}</span> <span class="n">x</span> <span class="n">y</span> <span class="o">=</span>
  <span class="kt">List</span><span class="o">.</span><span class="n">concatMap</span> <span class="p">(</span><span class="o">\</span><span class="n">n</span> <span class="o">-&gt;</span> <span class="kt">List</span><span class="o">.</span><span class="n">map</span> <span class="p">(</span><span class="o">\</span><span class="n">m</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">n</span><span class="o">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">m</span><span class="p">))</span>
                   <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="p">])</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="o">|&gt;</span> <span class="kt">List</span><span class="o">.</span><span class="n">filter</span> <span class="p">(</span><span class="o">\</span><span class="n">p</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">first</span> <span class="n">p</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">first</span> <span class="n">p</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">columns</span> <span class="o">&amp;&amp;</span>
                          <span class="p">(</span><span class="n">second</span> <span class="n">p</span><span class="p">)</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">second</span> <span class="n">p</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">rows</span> <span class="o">&amp;&amp;</span>
                          <span class="p">(</span><span class="n">not</span> <span class="p">((</span><span class="n">first</span> <span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">second</span> <span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="n">y</span><span class="p">)))</span>
    <span class="o">|&gt;</span> <span class="kt">List</span><span class="o">.</span><span class="n">filter</span> <span class="p">(</span><span class="o">\</span><span class="n">p</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">valueAt</span> <span class="p">(</span><span class="n">first</span> <span class="n">p</span><span class="p">)</span> <span class="kt">False</span>
                            <span class="p">(</span><span class="n">valueAt</span> <span class="p">(</span><span class="n">second</span> <span class="n">p</span><span class="p">)</span> <span class="p">[]</span> <span class="n">grid</span><span class="p">)))</span>
    <span class="o">|&gt;</span> <span class="kt">List</span><span class="o">.</span><span class="n">length</span>
    <span class="o">|&gt;</span> <span class="p">(</span><span class="o">\</span><span class="n">l</span> <span class="o">-&gt;</span> <span class="p">((</span><span class="n">valueAt</span> <span class="n">x</span> <span class="kt">False</span> <span class="p">(</span><span class="n">valueAt</span> <span class="n">y</span> <span class="p">[]</span> <span class="n">grid</span><span class="p">))</span>
                <span class="o">&amp;&amp;</span> <span class="n">l</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">||</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">valueAt</span> <span class="p">:</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">List</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="n">a</span>
<span class="n">valueAt</span> <span class="n">i</span> <span class="n">default</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="kt">Maybe</span><span class="o">.</span><span class="n">withDefault</span> <span class="n">default</span> <span class="p">(</span><span class="kt">List</span><span class="o">.</span><span class="n">head</span> <span class="p">(</span><span class="kt">List</span><span class="o">.</span><span class="n">drop</span> <span class="n">i</span> <span class="n">lst</span><span class="p">))</span>

<span class="n">setAt</span> <span class="p">:</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="o">-&gt;</span> <span class="n">a</span> <span class="o">-&gt;</span> <span class="kt">List</span> <span class="p">(</span><span class="kt">List</span> <span class="n">a</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">List</span> <span class="p">(</span><span class="kt">List</span> <span class="n">a</span><span class="p">)</span>
<span class="n">setAt</span> <span class="n">x</span> <span class="n">y</span> <span class="n">val</span> <span class="n">lst</span> <span class="o">=</span>
  <span class="k">let</span>
    <span class="n">inner</span> <span class="o">=</span> <span class="n">valueAt</span> <span class="n">x</span> <span class="p">[]</span> <span class="n">lst</span>
    <span class="n">updated</span> <span class="o">=</span> <span class="p">(</span><span class="kt">List</span><span class="o">.</span><span class="n">take</span> <span class="n">y</span> <span class="n">inner</span><span class="p">)</span> <span class="o">++</span> <span class="p">(</span><span class="n">val</span> <span class="o">::</span> <span class="p">(</span><span class="kt">List</span><span class="o">.</span><span class="n">drop</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="n">inner</span><span class="p">))</span>
  <span class="k">in</span>
    <span class="p">(</span><span class="kt">List</span><span class="o">.</span><span class="n">take</span> <span class="n">x</span> <span class="n">lst</span><span class="p">)</span> <span class="o">++</span> <span class="p">(</span><span class="n">updated</span> <span class="o">::</span> <span class="kt">List</span><span class="o">.</span><span class="n">drop</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="n">lst</span><span class="p">)</span></code></pre></figure> <h5><a href="/examples/elm/0.15/game_of_life_gold_plated/" target="_new">View Result <svg class="octicon octicon-link-external" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a></h5> </section> <p>This is, unfortunately, somewhat of a mess—not for any fault of Elm. The main problem is having kept everything in a single file in an attempt to make the example self-contained. Imagine separating out the <code class="language-plaintext highlighter-rouge">view</code> function (in conjunction with subordinates) and the <code class="language-plaintext highlighter-rouge">update</code> (with its helpers) into separate modules, leaving only the core logic in main file. Elm, in fact, is designed in such a way to facilitate (and even encourage) this sort of structure. Additionally, we should have also created a function for generating the range inputs in the <code class="language-plaintext highlighter-rouge">view</code> function, but that was also skipped in favor of making each diff atomic.</p> <p>Now, we return to the earlier point about the <code class="language-plaintext highlighter-rouge">setAt</code> helper function. This little nuisance points to a structural issue with this program. Specifically, the use of lists for this implementation is, most likely, suboptimal. Since we often make use of non-sequential access (via <code class="language-plaintext highlighter-rouge">valueAt</code>) and, in the final form, updates, we should have instead used Elm’s <span class="fancylink"> <a href="http://package.elm-lang.org/packages/elm-lang/core/5.1.1/Array">Array module</a> <span> <a href="http://package.elm-lang.org/packages/elm-lang/core/5.1.1/Array" target="_blank" alt="Pop Out" title="Pop Out"><svg class="octicon octicon-link-external" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> </span> </span>. This should be expected to increase performance, based on the way in which the two different data structures are <span class="fancylink"> <a href="https://stackoverflow.com/a/37707812">implemented internally</a> <span> <a href="https://stackoverflow.com/a/37707812" target="_blank" alt="Pop Out" title="Pop Out"><svg class="octicon octicon-link-external" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> </span> </span>. That said, having to be aware of the implementation details of the standard library of a language is never optimal, but, at a certain point, abstractions at face value can only go so far. Preference for lists over arrays has been <span class="fancylink"> <a href="https://github.com/elm-lang/elm-plans/issues/13">discussed</a> <span> <a href="https://github.com/elm-lang/elm-plans/issues/13" target="_blank" alt="Pop Out" title="Pop Out"><svg class="octicon octicon-link-external" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> </span> </span> before, but the proposal was dropped for lack of actual benchmarks pointing toward their universal superiority, and, as such, this potential optimization is naught but conjecture without further investigation.</p> <p>One last potential optimization worth exploring is the use of the <span class="fancylink"> <a href="http://package.elm-lang.org/packages/elm-lang/html/2.0.0/Html-Lazy"><code class="language-plaintext highlighter-rouge">HTML.Lazy</code></a> <span> <a href="http://package.elm-lang.org/packages/elm-lang/html/2.0.0/Html-Lazy" target="_blank" alt="Pop Out" title="Pop Out"><svg class="octicon octicon-link-external" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="M3.75 2h3.5a.75.75 0 0 1 0 1.5h-3.5a.25.25 0 0 0-.25.25v8.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25v-3.5a.75.75 0 0 1 1.5 0v3.5A1.75 1.75 0 0 1 12.25 14h-8.5A1.75 1.75 0 0 1 2 12.25v-8.5C2 2.784 2.784 2 3.75 2Zm6.854-1h4.146a.25.25 0 0 1 .25.25v4.146a.25.25 0 0 1-.427.177L13.03 4.03 9.28 7.78a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042l3.75-3.75-1.543-1.543A.25.25 0 0 1 10.604 1Z"></path></svg></a> </span> </span> module. In some cursory experiments, excluded from this article, the inclusion of lazy declarations in the various <code class="language-plaintext highlighter-rouge">view</code>, <code class="language-plaintext highlighter-rouge">row</code>, and <code class="language-plaintext highlighter-rouge">cell</code> functions did not noticeably improve performance under strenuous configurations.</p> <p>Overall, this example has admirably performed its task of giving us context within which to modify an Elm program. As evidenced by the increasingly trivial, practically repetitive, nature of the modifications, it is fair to presume changes will normally follow the same simple pattern of updating union types, dispatching messages via the user interface, and handling these new cases in the update cycle. Some larger changes will necessitate changes to the flow of data through the application (as seen during model unification and the addition of mouse reactivity), but even these changes are mostly local in scope. As a consequence of strong type checking, Elm also ensures, at compile time, that any such cascading change is handled by the developer. From a maintainability perspective, this makes a very compelling case for the Elm programming language.</p> <span class="post-date">18 Jun 2017</span> </div> <div class="related"> <h2>Related Posts</h2> <ul class="related-posts"> <li> <h3> <a href="/2017/05/22/revisiting-the-game-of-life-in-elm/"> Revisiting the Game of Life in Elm <small>22 May 2017</small> </a> </h3> </li> <li> <h3> <a href="/2017/06/05/common-table-expressions-in-activerecord-a-case-study-of-quantiles/"> Common Table Expressions in ActiveRecord: A Case Study of Quantiles <small>05 Jun 2017</small> </a> </h3> </li> <li> <h3> <a href="/2018/11/19/types-in-elm-decomposition-and-ad-hoc-polymorphism/"> Types in Elm: Decomposition and Ad Hoc Polymorphism <small>19 Nov 2018</small> </a> </h3> </li> </ul> </div> <p class="bitcoin"></p> </div> </body> </html>